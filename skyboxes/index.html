<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>å¤©ç©ºç›’</title>
    <style>
      html,
      body {
        overflow: hidden;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

      #renderCanvas {
        width: 100%;
        height: 100%;
        touch-action: none;
      }
    </style>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
  </head>

  <body>
    <canvas id="renderCanvas"></canvas>
    <script>
      // è·å– canvas å…ƒç´ 
      const canvas = document.getElementById('renderCanvas')
      // åˆå§‹åŒ– Babylon.js å¼•æ“
      const engine = new BABYLON.Engine(canvas, true)

      const createScene = function () {
        var scene = new BABYLON.Scene(engine)

        // åˆ›å»ºå¤©ç©ºç›’
        var skybox = BABYLON.MeshBuilder.CreateBox(
          'skyBox',
          { size: 1000 },
          scene
        )

        // è®¾ç½®å¤©ç©ºç›’è·Ÿéšç›¸æœº
        skybox.infiniteDistance = true

        // åˆ›å»ºæ ‡å‡†æè´¨ï¼Œåä¸º skyBox
        var skyboxMaterial = new BABYLON.StandardMaterial('skyBox', scene)

        /**
           CubeTexture  åˆ›å»ºä¸€ä¸ªç«‹æ–¹ä½“çº¹ç†ï¼Œä¾‹å¦‚ç”¨äºåå°„ã€‚å®ƒå¯ä»¥åŸºäºddsæˆ–å…­ä¸ªå›¾åƒï¼Œä»¥åŠé¢„è¿‡æ»¤çš„æ•°æ®ã€‚
            @param rootUrl å®šä¹‰çº¹ç†çš„urlæˆ–å…­ä¸ªå›¾åƒçš„æ ¹åç§°
            @param sceneOrEngine å®šä¹‰çº¹ç†æ‰€é™„åŠ çš„åœºæ™¯æˆ–å¼•æ“
            @param extensionsOrOptions å®šä¹‰åœ¨ä½¿ç”¨å…­ä¸ªå›¾åƒçš„æƒ…å†µä¸‹æ·»åŠ åˆ°å›¾ç‰‡åç§°çš„åç¼€ï¼Œå¦‚_px.jpgï¼Œæˆ–åˆ›å»ºç«‹æ–¹ä½“çº¹ç†çš„æ‰€æœ‰é€‰é¡¹é›†
            @param noMipmap å®šä¹‰æ˜¯å¦åº”åˆ›å»ºmipmap
            @param files å®šä¹‰è¦æŒ‰ç…§ä»¥ä¸‹é¡ºåºåŠ è½½çš„å…­ä¸ªæ–‡ä»¶çš„ä¸åŒé¢ï¼špx, py, pz, nx, ny, nz
            @param onLoad å®šä¹‰åœ¨æ–‡ä»¶åŠ è½½ç»“æŸæ—¶å¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿè§¦å‘çš„å›è°ƒ
            @param onError å®šä¹‰åœ¨åŠ è½½è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘çš„å›è°ƒ
            @param format å®šä¹‰ä¸€æ—¦åŠ è½½çº¹ç†åè¦ä½¿ç”¨çš„å†…éƒ¨æ ¼å¼
            @param prefiltered å®šä¹‰çº¹ç†æ˜¯å¦ä»é¢„è¿‡æ»¤çš„æ•°æ®åˆ›å»º
            @param forcedExtension å®šä¹‰è¦ä½¿ç”¨çš„æ‰©å±•åï¼ˆå¼ºåˆ¶åŠ è½½ç‰¹å®šç±»å‹çš„æ–‡ä»¶ï¼‰ï¼Œä»¥é˜²å®ƒä¸æ–‡ä»¶åä¸åŒ
            @param createPolynomials å®šä¹‰æ˜¯å¦éœ€è¦ä»çº¹ç†æ•°æ®åˆ›å»ºå¤šé¡¹å¼è°æ³¢
            @param lodScale å®šä¹‰åº”ç”¨äºç¯å¢ƒçº¹ç†çš„æ¯”ä¾‹ã€‚è¿™ç®¡ç†äº†æ ¹æ®ç²—ç³™åº¦ç”¨äºIBLçš„LODçº§åˆ«çš„èŒƒå›´
            @param lodOffset å®šä¹‰åº”ç”¨äºç¯å¢ƒçº¹ç†çš„åç§»ã€‚è¿™ç®¡ç†äº†æ ¹æ®ç²—ç³™åº¦ç”¨äºIBLçš„ç¬¬ä¸€ä¸ªLODçº§åˆ«
            @param loaderOptions è¦ä¼ é€’ç»™åŠ è½½å™¨çš„é€‰é¡¹
            @param useSRGBBuffer å®šä¹‰çº¹ç†æ˜¯å¦å¿…é¡»åœ¨sRGB GPUç¼“å†²åŒºä¸­åŠ è½½ï¼ˆå¦‚æœGPUæ”¯æŒï¼‰ï¼ˆé»˜è®¤ï¼šfalseï¼‰
            @returns ç«‹æ–¹ä½“çº¹ç†
        */
        // constructor(
        //     rootUrl: string,
        //     sceneOrEngine: Scene | AbstractEngine,
        //     extensionsOrOptions: Nullable<string[] | ICubeTextureCreationOptions> = null,
        //     noMipmap: boolean = false,
        //     files: Nullable<string[]> = null,
        //     onLoad: Nullable<() => void> = null,
        //     onError: Nullable<(message?: string, exception?: any) => void> = null,
        //     format: number = Constants.TEXTUREFORMAT_RGBA,
        //     prefiltered = false,
        //     forcedExtension: any = null,
        //     createPolynomials: boolean = false,
        //     lodScale: number = defaultLodScale,
        //     lodOffset: number = 0,
        //     loaderOptions?: any,
        //     useSRGBBuffer?: boolean
        // ) {}

        // åˆ›å»ºä¸€ä¸ª CubeTexture å¹¶èµ‹å€¼ç»™ skyBox çš„ reflectionTexture å±æ€§
        // skyboxMaterial.reflectionTexture = new BABYLON.CubeTexture(
        //   './imgs/1',
        //   scene
        // )
        const skyboxTexture = BABYLON.CubeTexture.CreateFromImages(
          [
            './skyBox/skyBox2/negx.jpg',
            './skyBox/skyBox2/negy.jpg',
            './skyBox/skyBox2/negz.jpg',
            './skyBox/skyBox2/posx.jpg',
            './skyBox/skyBox2/posy.jpg',
            './skyBox/skyBox2/posz.jpg'
          ],
          scene
        )

        // âœ… ç›‘å¬å¤©ç©ºç›’åŠ è½½å®Œæˆ
        skyboxTexture.onLoadObservable.add(() => {
          console.log('ğŸŒŸ å¤©ç©ºç›’çº¹ç†åŠ è½½å®Œæˆï¼')
          // å¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œé¢å¤–çš„é€»è¾‘ï¼Œæ¯”å¦‚å¯åŠ¨ç›¸æœºåŠ¨ç”»
        })

        // âœ… ç›‘å¬åŠ è½½é”™è¯¯
        skyboxTexture.onError = (message, exception) => {
          console.error('âŒ å¤©ç©ºç›’åŠ è½½å¤±è´¥:', message, exception)
        }

        skyboxMaterial.reflectionTexture = skyboxTexture
        // åˆ«å¿˜äº†æŠŠæè´¨ç»™åˆ° skybox
        skybox.material = skyboxMaterial

        // å…³é—­èƒŒé¢å‰”é™¤ï¼Œè®©æˆ‘ä»¬èƒ½çœ‹åˆ°ç«‹æ–¹ä½“çš„å†…ä¾§
        skyboxMaterial.backFaceCulling = false
        // çº¹ç†ä»¥å¤©ç©ºç›’çš„æ–¹å¼è¿›è¡Œæ¸²æŸ“ï¼Œå®ƒå†…éƒ¨ä¼šå»å¸®ä½ æŠŠå›¾ä¸å›¾ä¹‹é—´çš„çªå…€ç»™å¤„ç†å¥½ï¼š
        skyboxMaterial.reflectionTexture.coordinatesMode =
          BABYLON.Texture.SKYBOX_MODE
        // ç›´æ¥æŠŠæ‰€æœ‰å…‰å¯¹å¤©ç©ºç›’æè´¨çš„åå°„ç»™ç¦ç”¨æ‰ï¼š
        skyboxMaterial.disableLighting = true
        // æˆ–è€…ä½¿ç”¨å¦ä¸€ç§æ–¹å¼ï¼šå› ä¸º StandardMaterialçš„æ¼«åå°„é¢œè‰² diffuseColorå’Œé«˜å…‰é¢œè‰² specularColoréƒ½æ˜¯ç™½è‰²ï¼Œæ‰€ä»¥ä¼šæ˜¾å¾—å¾ˆäº®ï¼Œ
        // æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥æŠŠå®ƒä»¬ä¸‰ä¸ªé¢œè‰²é€šé“éƒ½è®¾ç½®ä¸º0ï¼Œè®©å®ƒä¸é‚£ä¹ˆäº®
        // skyboxMaterial.diffuseColor = new BABYLON.Color3(0, 0, 0)
        // skyboxMaterial.specularColor = new BABYLON.Color3(0, 0, 0)

        var light = new BABYLON.HemisphericLight(
          'default light',
          BABYLON.Vector3.Up(),
          scene
        )

        // ç›¸æœºçš„ target ä¸º (550, 0, 0)
        var camera = new BABYLON.ArcRotateCamera(
          'Camera',
          2.5,
          1.5,
          50,
          new BABYLON.Vector3(0, 0, 0),
          scene
        )
        camera.attachControl()
        // camera.target = new BABYLON.Vector3(550, 0, 0)
        camera.radius = 200

        // // çƒçš„åŠå¾„ä¸º 50, ä½ç½®ä¸º (550, 0, 0)
        // var sphere1 = BABYLON.MeshBuilder.CreateSphere(
        //   'sphere',
        //   { segments: 30, diameter: 50 },
        //   scene
        // )
        // sphere1.position = new BABYLON.Vector3(550, 0, 0)

        var sphere = BABYLON.MeshBuilder.CreateSphere(
          'sphere',
          { segments: 30, diameter: 1 },
          scene
        )
        sphere.position = new BABYLON.Vector3(0, 0, 0)

        return scene
      }

      // åˆ›å»ºåœºæ™¯
      const scene = createScene()
      // æ³¨å†Œä¸€ä¸ªæ¸²æŸ“å¾ªç¯ï¼Œä»¥ä¾¿åœ¨æ¯ä¸€å¸§éƒ½æ¸²æŸ“åœºæ™¯
      engine.runRenderLoop(function () {
        scene.render()
      })
      // ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼Œè°ƒæ•´å¼•æ“çš„å¤§å°
      window.addEventListener('resize', function () {
        engine.resize()
      })
    </script>
  </body>
</html>
